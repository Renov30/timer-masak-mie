<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- my font -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Pixelify+Sans:wght@400..700&display=swap"
      rel="stylesheet"
    />
    <!-- my font 2 -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Jersey+20&display=swap"
      rel="stylesheet"
    />

    <style>
      /* css untuk font */
      .pixelify {
        font-family: "Pixelify Sans", sans-serif;
        font-optical-sizing: auto;
      }

      .jersey20 {
        font-family: "Jersey 20", sans-serif;
        font-weight: 400;
        font-style: normal;
      }

      /* css untuk animasi talkview */
      @keyframes blinkMove {
        0%,
        100% {
          opacity: 0;
          transform: translateY(0);
        }

        50% {
          opacity: 1;
          transform: translateY(5px);
        }
      }

      .animate-talk {
        animation: blinkMove 1.5s infinite ease-in-out;
      }

      .hidden-talk {
        opacity: 0;
        animation: none !important;
      }
    </style>
    <!-- tailwind css -->
    <link href="./output.css" rel="stylesheet" />
    <title>MieTime</title>
  </head>
  <body
    class="flex justify-center min-h-screen items-center bg-gradient-to-b from-[#ff9433] to-[#ffb640]"
  >
    <button
      id="toggleBGM"
      class="fixed top-5 left-10 bg-amber-600 text-white px-3 py-2 rounded-xl"
    >
      ðŸ”‡
    </button>
    <audio id="bgm" src="audio/journey.mp3" loop></audio>
    <!-- halaman 1 -->
    <div id="hal1" class="mx-5">
      <div class="relative">
        <img src="img/ani2.png" alt="talk1" class="z-0" />
        <p
          id="textHal1"
          class="pixelify text-white text-center mx-10 z-10 absolute inset-0 flex items-center justify-center mt-50"
        >
          -
        </p>
        <div class="absolute inset-0 z-10 flex items-end justify-end mb-7 mr-7">
          <img
            id="talkview"
            src="img/talk1.png"
            alt="talkview"
            class="w-8 animate-talk hidden-talk"
          />
        </div>
      </div>
      <div class="flex justify-end">
        <button onclick="next1()" class="relative">
          <img src="img/btn2empt.png" alt="button-bg" class="w-45 h-auto" />
          <span
            class="pixelify absolute inset-0 flex items-center justify-center text-white font-bold"
          >
            NEXT
          </span>
        </button>
      </div>
    </div>
    <!-- halaman 2 -->
    <!-- anyway, what kinda noodle you wanna cook this time? -->
    <div id="hal2" class="hidden mx-5">
      <div class="relative">
        <img src="img/ani1.png" alt="talk1" class="z-0" />
        <p
          id="textHal2"
          class="pixelify text-white text-center mx-10 z-10 absolute inset-0 flex items-center justify-center mt-50"
        >
          -
        </p>
        <div class="absolute inset-0 z-10 flex items-end justify-end mb-7 mr-7">
          <img
            id="talkview2"
            src="img/talk1.png"
            alt="talkview"
            class="w-8 animate-talk hidden-talk"
          />
        </div>
      </div>
      <div class="flex justify-end">
        <button onclick="next2()" class="relative">
          <img src="img/btn2empt.png" alt="button-bg" class="w-45 h-auto" />
          <span
            class="pixelify absolute inset-0 flex items-center justify-center text-white font-bold"
          >
            NEXT
          </span>
        </button>
      </div>
    </div>
    <!-- halaman 3 -->
    <div id="hal3" class="hidden w-full">
      <div class="flex flex-col justify-center items-center">
        <div class="flex items-center">
          <img
            id="noodleImg"
            src="img/noodle1.png"
            alt="noodle"
            class="w-60 h-auto"
          />
        </div>

        <div class="mx-8 flex items-center justify-center relative mb-3">
          <div class="absolute inset-0 flex flex-col justify-center">
            <p
              id="title"
              class="text-xl font-bold pixelify text-white text-center"
            >
              mie kuah biasa
            </p>
            <p id="detail" class="pixelify text-white text-center mx-5">-</p>
          </div>
          <img src="img/detail.png" alt="detail" />
        </div>

        <div class="flex justify-center w-full">
          <button id="prevBtn">
            <img
              src="img/prev.png"
              alt="prev"
              class="w-10 h-10 sm:w-10 sm:h-10 md:w-12 md:h-12 lg:w-14 lg:h-14 object-contain"
            />
          </button>
          <button onclick="startTimer()" class="relative w-40 h-auto">
            <img src="img/start.png" alt="start" />
            <span
              class="absolute inset-0 flex items-center justify-center text-white font-bold"
              >START</span
            >
          </button>
          <button id="nextBtn">
            <img
              src="img/next.png"
              alt="next"
              class="w-10 h-10 sm:w-10 sm:h-10 md:w-12 md:h-12 lg:w-14 lg:h-14 object-contain"
            />
          </button>
        </div>
      </div>
    </div>
    <!-- halaman 4 -->
    <div id="hal4" class="hidden mx-5">
      <div class="flex flex-col justify-center items-center">
        <img src="img/noodle1.png" alt="cooking" class="w-60 h-auto" />
        <p class="pixelify text-center text-white">
          mie kamu akan masak dalam :
        </p>
        <h1 class="jersey20 text-8xl text-white text-center">03:00</h1>
      </div>
      <div class="flex">
        <button id="resetBtn" class="relative w-40 h-auto">
          <img src="img/start.png" alt="pause" />
          <p
            class="pixelify absolute inset-0 flex items-center justify-center z-10 text-white"
          >
            RESET
          </p>
        </button>
        <button id="pauseBtn" class="relative w-40 h-auto">
          <img src="img/start.png" alt="pause" />
          <p
            class="pixelify absolute z-10 inset-0 flex items-center justify-center text-white"
          >
            PAUSE
          </p>
        </button>
      </div>
    </div>
  </body>
  <!-- javascript -->
  <script>
    // script bicara untuk animasi hal 1
    // variabel hal 1 dan 2
    const hal1 = document.getElementById("hal1");
    const hal2 = document.getElementById("hal2");
    const textHal1 = document.getElementById("textHal1");
    const talkView = document.getElementById("talkview");

    // sembunyikan talkview
    talkView.style.opacity = 0;

    // variabel array pembicaraan animasi hal 1
    const conversation = [
      [
        "makan mie instan lagi?",
        "you know.. you really should eat something else",
        "i mean, look at you",
      ],
      [
        "mie trooss...",
        "what? are you trying to save money to buy an iphone?",
        ".. not worth it pal",
      ],
      [
        "udah berapa kali lu makan mie bulan ini?",
        "i don't know who you are, but i'll eat some more vegies if i were you",
        "you don't want gerd don't you",
      ],
    ];
    // pilih conversation dari array: hasilkan angka random dikali jumlah array, jadi karena array (3) maka angka random 0-0.99 dikali 1-3 = contoh hasilnya 0.7 = 1
    const chooseConversation =
      conversation[Math.floor(Math.random() * conversation.length)];

    // variabel untuk selalu pilih urutan percakapan pertama dalam array
    // pakai let biar bisa diubah nilainya, dikasih 0 biar dipilih yang paling awal
    let indexConversationHal1 = 0;

    // buat objek audio global biar bisa dipakai ulang
    const typingSound = new Audio("audio/soft-hit-2.wav");
    typingSound.volume = 0.1; // atur volume biar nggak berisik

    // fungsi untuk memutar ulang suara tiap huruf
    function playTypingSound() {
      // kloning audio biar bisa overlap antar huruf (tanpa delay)
      const sound = typingSound.cloneNode();
      sound.play();
    }

    // fungsi animasi ngetik teks
    function typeText(text, callback) {
      textHal1.textContent = "";
      talkView.classList.add("hidden-talk"); // sembunyikan & matikan animasi

      let i = 0;
      const speed = 40;

      const typing = setInterval(() => {
        if (i < text.length) {
          textHal1.textContent += text.charAt(i);
          playTypingSound();
          i++;
        } else {
          clearInterval(typing);
          // tunggu sedikit lalu tampilkan segitiga
          setTimeout(() => {
            talkView.classList.remove("hidden-talk"); // tampilkan + aktifkan animasi lagi
          }, 200);
          if (callback) callback();
        }
      }, speed);
    }
    // tampilkan text dimana conversation yang dipilih dengan urutan teks yang pertama (tapi dalam animasi typing)
    typeText(chooseConversation[indexConversationHal1]);

    // fungsi ganti ke urutan percakapan selanjutnya
    function next1() {
      // pastikan animasi ngetik selesai sebelum lanjut
      if (textHal1.textContent !== chooseConversation[indexConversationHal1])
        return;

      // kalau urutannya lebih kecil dari panjang conversation yang dipilih contoh 3 maka dia dikurang 1 karena mulainya dari 0
      if (indexConversationHal1 < chooseConversation.length - 1) {
        // tambah nilai untuk ganti urutan
        indexConversationHal1++;

        // masukan ke html (dengan animasi typing)
        typeText(chooseConversation[indexConversationHal1]);
      } else {
        hal2.classList.remove("hidden");
        hal1.classList.add("hidden");

        // mulai animasi typing di hal2
        typeTextHal2(textHal2Content);
      }
    }
    // elemen-elemen halaman 2
    const hal3 = document.getElementById("hal3"); // misal nanti kamu punya hal3
    const textHal2 = document.getElementById("textHal2");
    const talkView2 = document.getElementById("talkview2");

    // teks halaman 2
    const textHal2Content = "anyway, kamu mau masak mie apa hari ini?";

    // fungsi animasi ngetik untuk hal2
    function typeTextHal2(text, callback) {
      textHal2.textContent = "";
      talkView2.classList.add("hidden-talk"); // sembunyikan segitiga

      let i = 0;
      const speed = 40;

      const typing = setInterval(() => {
        if (i < text.length) {
          textHal2.textContent += text.charAt(i);
          playTypingSound();
          i++;
        } else {
          clearInterval(typing);
          setTimeout(() => {
            talkView2.classList.remove("hidden-talk"); // tampilkan segitiga
          }, 200);
          if (callback) callback();
        }
      }, speed);
    }

    // fungsi ganti hal2 ke hal3
    function next2() {
      hal2.classList.add("hidden");
      hal3.classList.remove("hidden");
    }
    // script untuk pilih menu hal 3
    // variabel object informasi mie
    const noodles = [
      {
        title: "mie kuah biasa",
        img: "img/noodle1.png",
        detail: "waktu masak 3 menit. cocok buat kamu yang suka mie kuah.",
        time: 180,
      },
      {
        title: "mie setengah matang",
        img: "img/noodle1.png",
        detail: "waktu masak 1 menit. boleh dicoba kalau kamu anti mainstream.",
        time: 60,
      },
      {
        title: "mie benyek",
        img: "img/noodle1.png",
        detail: "waktu masak 5 menit. cocok kalau kamu orangnya aneh.",
        time: 300,
      },
    ];
    // variabel mie ke berapa
    let mieIndex = 0;
    // variabel komponen informasi mie
    const titleNoodle = document.getElementById("title");
    const imgNoodle = document.getElementById("noodleImg");
    const detailNoodle = document.getElementById("detail");
    const prev = document.getElementById("prevBtn");
    const next = document.getElementById("nextBtn");
    // fungsi ganti mie
    function gantiMie() {
      const mie = noodles[mieIndex];
      titleNoodle.textContent = mie.title;
      imgNoodle.src = mie.img;
      detailNoodle.textContent = mie.detail;
    }
    // event listener kalau tombol next ditekan
    next.addEventListener("click", () => {
      // tambah index untuk ganti mie
      mieIndex = (mieIndex + 1) % noodles.length;
      gantiMie();
    });
    // event listener kalau tombol prev ditekan
    prev.addEventListener("click", () => {
      // kurangi index kemudian tambahkan dengan jumlah objek di satu array
      mieIndex = (mieIndex - 1 + noodles.length) % noodles.length;
      gantiMie();
    });
    // inisialisai
    gantiMie();

    // script halaman timer
    const hal4 = document.getElementById("hal4");
    // variabel untuk tampilkan timer
    const timerDisplay = hal4.querySelector("h1");
    // variabel tombol pause dan reset
    const pauseBtn = document.getElementById("pauseBtn");
    const resetBtn = document.getElementById("resetBtn");

    // variabel untuk timer
    let countDown = null;
    // variabel waktu tersisa
    let timeLeft = 0;
    // variabel di pause atau tidak
    let isPaused = false;

    // fungsi update tampilan timer/ update angkanya
    function updateTimerDisplay(seconds) {
      // variabel untuk menit
      const min = String(Math.floor(seconds / 60)).padStart(2, "0");
      // variabel untuk detik
      const sec = String(seconds % 60).padStart(2, "0");
      // tampilkan di h1
      timerDisplay.textContent = `${min}:${sec}`;
    }

    // fungsi tick, fungsi yang dijalankan setiap detik
    function tick() {
      if (isPaused) return;
      // kurangi nilai timeleft sebanyak 1 kali setiap interval berjalan
      timeLeft--;
      // panggil update
      updateTimerDisplay(timeLeft);
      // jika timeleft kurang dari 0 tampilkan selesai
      if (timeLeft <= 0) {
        clearInterval(countDown);
        timerDisplay.textContent = "SELESAI!";
      }
    }

    // fungsi mulai timer
    function startTimer() {
      // sembunyikan hal 3 tampilkan hal 4
      hal3.classList.add("hidden");
      hal4.classList.remove("hidden");
      // bersihkan interval variabel untuk timer kalau ada
      clearInterval(countDown);
      // ambil waktu dari object mie yang dipilih
      timeLeft = noodles[mieIndex].time;
      // tampilkan waktu di awal (kirim timeleft ke updatetimerdisplay)
      updateTimerDisplay(timeLeft);

      // kalau tidak pause maka jalankan interval
      isPaused = false;
      countDown = setInterval(tick, 1000);
    }

    // event listener tombol pause dan reset
    pauseBtn.addEventListener("click", pauseTimer);
    resetBtn.addEventListener("click", resetTimer);

    // fungsi pause timer
    function pauseTimer() {
      // toggle pause/resume (bolak balik)
      isPaused = !isPaused;
      // ganti text di tombol
      pauseBtn.querySelector("p").textContent = isPaused ? "RESUME" : "PAUSE";
    }

    // fungsi reset timer
    function resetTimer() {
      clearInterval(countDown);
      timeLeft = noodles[mieIndex].time;
      updateTimerDisplay(timeLeft);
      isPaused = false;
      pauseBtn.querySelector("p").textContent = "PAUSE";
      countDown = setInterval(tick, 1000);
    }

    const toggleBtn = document.getElementById("toggleBGM");
    let bgmPlaying = false;

    toggleBtn.addEventListener("click", () => {
      if (bgmPlaying) {
        bgm.pause();
        toggleBtn.textContent = "ðŸ”‡";
        // toggleBtn.textContent = "ðŸ”‡ Music Off";
      } else {
        bgm.play();
        toggleBtn.textContent = "ðŸ”ˆ";
        // toggleBtn.textContent = "ðŸ”ˆ Music On";
      }
      bgmPlaying = !bgmPlaying;
    });
  </script>
</html>

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- my font -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Pixelify+Sans:wght@400..700&display=swap"
      rel="stylesheet"
    />
    <!-- my font 2 -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Jersey+20&display=swap"
      rel="stylesheet"
    />

    <style>
      /* css untuk font */
      .pixelify {
        font-family: "Pixelify Sans", sans-serif;
        font-optical-sizing: auto;
        font-size: 4vw;
      }

      .pixelify-unresponsive {
        font-family: "Pixelify Sans", sans-serif;
        font-optical-sizing: auto;
      }

      .jersey20 {
        font-family: "Jersey 20", sans-serif;
        font-weight: 400;
        font-style: normal;
      }

      /* css untuk animasi talkview */
      @keyframes blinkMove {
        0%,
        100% {
          opacity: 0;
          transform: translateY(0);
        }

        50% {
          opacity: 1;
          transform: translateY(5px);
        }
      }

      .animate-talk {
        animation: blinkMove 1.5s infinite ease-in-out;
      }

      .hidden-talk {
        opacity: 0;
        animation: none !important;
      }

      .page {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;

        display: flex; /* Bikin flex container */
        justify-content: center; /* Tengah horizontal */
        /* align-items: center; Tengah vertikal */
        flex-direction: column; /* Susun konten dari atas ke bawah */

        /* width: 100%; */
        height: 100%; /* tambahkan ini biar tinggi penuh */
        opacity: 0;
        transform: translateX(100%);
        transition: transform 0.6s ease, opacity 0.6s ease;
      }

      /* halaman yang sedang tampil */
      .page.active {
        opacity: 1;
        transform: translateX(0);
        z-index: 2;
      }

      /* halaman yang keluar ke kiri */
      .page.exit-left {
        transform: translateX(-100%);
        opacity: 0;
        z-index: 1;
      }

      /* halaman yang keluar ke kanan */
      .page.exit-right {
        transform: translateX(100%);
        opacity: 0;
        z-index: 1;
      }

      /* biar hidden tetap sembunyi */
      .page.hidden {
        display: none;
      }

      /* Animasi keluar ke kiri (saat klik next) */
      .slide-out-left {
        animation: slideOutLeft 0.4s ease forwards;
      }

      @keyframes slideOutLeft {
        from {
          opacity: 1;
          transform: translateX(0);
        }
        to {
          opacity: 0;
          transform: translateX(-100%);
        }
      }

      /* Animasi masuk dari kanan (saat klik next) */
      .slide-in-right {
        animation: slideInRight 0.4s ease forwards;
      }

      @keyframes slideInRight {
        from {
          opacity: 0;
          transform: translateX(100%);
        }
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }

      /* Animasi keluar ke kanan (saat klik prev) */
      .slide-out-right {
        animation: slideOutRight 0.4s ease forwards;
      }

      @keyframes slideOutRight {
        from {
          opacity: 1;
          transform: translateX(0);
        }
        to {
          opacity: 0;
          transform: translateX(100%);
        }
      }

      /* Animasi masuk dari kiri (saat klik prev) */
      .slide-in-left {
        animation: slideInLeft 0.4s ease forwards;
      }

      @keyframes slideInLeft {
        from {
          opacity: 0;
          transform: translateX(-100%);
        }
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }
    </style>
    <!-- tailwind css -->
    <link href="./output.css" rel="stylesheet" />
    <title>MieTime</title>
  </head>
  <body
    class="flex justify-center min-h-screen items-center bg-gradient-to-b from-[#ff9433] to-[#ffb640]"
  >
    <button
      id="toggleBGM"
      class="fixed top-5 left-10 bg-amber-600 text-white px-3 py-2 rounded-xl z-99"
    >
      ðŸ”‡
    </button>
    <audio id="bgm" loop></audio>

    <div id="game-container" class="relative overflow-hidden w-full h-screen">
      <!-- halaman 1 -->
      <div id="hal1" class="page active mx-5">
        <div class="relative">
          <img src="img/ani2.png" alt="talk1" class="z-0 w-full h-auto" />
          <div
            class="absolute inset-0 flex items-center justify-center pt-[55%]"
          >
            <p
              id="textHal1"
              class="pixelify text-white text-center mx-10 z-10 leading-snug"
            >
              -
            </p>
          </div>
          <div
            class="absolute inset-0 z-10 flex items-end justify-end mb-7 mr-7"
          >
            <img
              id="talkview"
              src="img/talk1.png"
              alt="talkview"
              class="w-8 animate-talk hidden-talk"
            />
          </div>
        </div>
        <div class="flex justify-end">
          <button onclick="next1()" class="relative">
            <img src="img/btn2empt.png" alt="button-bg" class="w-45 h-auto" />
            <span
              class="pixelify absolute inset-0 flex items-center justify-center text-white font-bold"
            >
              NEXT
            </span>
          </button>
        </div>
      </div>
      <!-- halaman 2 -->
      <div id="hal2" class="page hidden mx-5">
        <div class="relative">
          <img src="img/ani1.png" alt="talk1" class="z-0 w-full h-auto" />
          <div
            class="absolute inset-0 flex items-center justify-center pt-[55%]"
          >
            <p
              id="textHal2"
              class="pixelify text-white text-center mx-10 z-10 leading-snug"
            >
              -
            </p>
          </div>
          <div
            class="absolute inset-0 z-10 flex items-end justify-end mb-7 mr-7"
          >
            <img
              id="talkview2"
              src="img/talk1.png"
              alt="talkview"
              class="w-8 animate-talk hidden-talk"
            />
          </div>
        </div>
        <div class="flex justify-end">
          <button onclick="next2()" class="relative">
            <img src="img/btn2empt.png" alt="button-bg" class="w-45 h-auto" />
            <span
              class="pixelify absolute inset-0 flex items-center justify-center text-white font-bold"
            >
              NEXT
            </span>
          </button>
        </div>
      </div>
      <!-- halaman 3 -->
      <div id="hal3" class="page hidden w-full">
        <div class="flex flex-col justify-center items-center">
          <div class="flex items-center">
            <img
              id="noodleImg"
              src="img/noodle1.png"
              alt="noodle"
              class="w-60 h-auto"
            />
          </div>

          <div class="mx-8 flex items-center justify-center relative mb-3">
            <div class="absolute inset-0 flex flex-col justify-center">
              <p
                id="title"
                class="pixelify-unresponsive text-xl font-bold text-white text-center"
              >
                mie kuah biasa
              </p>
              <p id="detail" class="pixelify text-white text-center mx-6">-</p>
            </div>
            <img src="img/detail.png" alt="detail" />
          </div>

          <div class="flex justify-center w-full">
            <button id="prevBtn">
              <img
                src="img/prev.png"
                alt="prev"
                class="w-10 h-10 sm:w-10 sm:h-10 md:w-12 md:h-12 lg:w-14 lg:h-14 object-contain"
              />
            </button>
            <button onclick="startTimer()" class="relative w-40 h-auto">
              <img src="img/start.png" alt="start" />
              <span
                class="absolute inset-0 flex items-center justify-center text-white font-bold"
                >START</span
              >
            </button>
            <button id="nextBtn">
              <img
                src="img/next.png"
                alt="next"
                class="w-10 h-10 sm:w-10 sm:h-10 md:w-12 md:h-12 lg:w-14 lg:h-14 object-contain"
              />
            </button>
          </div>
        </div>
      </div>
      <!-- halaman 4 -->
      <div id="hal4" class="page hidden mx-5">
        <button
          id="menuBtn"
          class="pixelify fixed top-5 right-5 bg-amber-600 text-white px-3 py-2 rounded-xl"
        >
          menu
        </button>
        <div class="flex flex-col justify-center items-center">
          <img src="img/noodle1.png" alt="cooking" class="w-60 h-auto" />
          <p class="pixelify text-center text-white">
            mie kamu akan masak dalam :
          </p>
          <h1 class="jersey20 text-8xl text-white text-center">00:00</h1>
        </div>
        <div class="flex items-center justify-center">
          <button id="resetBtn" class="relative w-40 h-auto">
            <img src="img/start.png" alt="pause" />
            <p
              class="pixelify absolute inset-0 flex items-center justify-center z-10 text-white"
            >
              RESET
            </p>
          </button>
          <button id="pauseBtn" class="relative w-40 h-auto">
            <img src="img/start.png" alt="pause" />
            <p
              class="pixelify absolute z-10 inset-0 flex items-center justify-center text-white"
            >
              PAUSE
            </p>
          </button>
        </div>
      </div>
    </div>
  </body>
  <!-- javascript -->
  <script>
    const clickSound = new Audio("audio/sfx/click.mp3");
    const selectSound = new Audio("audio/sfx/select.mp3");
    const pauseSound = new Audio("audio/sfx/toggle.mp3");
    // script bicara untuk animasi hal 1
    // variabel hal 1 dan 2
    const hal1 = document.getElementById("hal1");
    const hal2 = document.getElementById("hal2");
    const textHal1 = document.getElementById("textHal1");
    const talkView = document.getElementById("talkview");

    // sembunyikan talkview
    talkView.style.opacity = 0;

    // variabel array pembicaraan animasi hal 1
    const conversation = [
      [
        "makan mie instan lagi?",
        "you know.. you really should eat something else",
        "i mean, look at you",
      ],
      [
        "mie trooss...",
        "what? are you trying to save money to buy an iphone?",
        ".. not worth it pal",
      ],
      [
        "udah berapa kali lu makan mie bulan ini?",
        "i don't know who you are, but i'll eat some more vegies if i were you",
        "you don't want gerd don't you",
      ],
    ];
    // pilih conversation dari array: hasilkan angka random dikali jumlah array, jadi karena array (3) maka angka random 0-0.99 dikali 1-3 = contoh hasilnya 0.7 = 1
    const chooseConversation =
      conversation[Math.floor(Math.random() * conversation.length)];

    // variabel untuk selalu pilih urutan percakapan pertama dalam array
    // pakai let biar bisa diubah nilainya, dikasih 0 biar dipilih yang paling awal
    let indexConversationHal1 = 0;

    // buat objek audio global biar bisa dipakai ulang
    const typingSound = new Audio("audio/soft-hit-2.wav");
    typingSound.volume = 0.1; // atur volume biar nggak berisik

    // fungsi untuk memutar ulang suara tiap huruf
    function playTypingSound() {
      // kloning audio biar bisa overlap antar huruf (tanpa delay)
      const sound = typingSound.cloneNode();
      sound.play();
    }

    // fungsi animasi ngetik teks
    function typeText(text, callback) {
      textHal1.textContent = "";
      talkView.classList.add("hidden-talk"); // sembunyikan & matikan animasi

      let i = 0;
      const speed = 40;

      const typing = setInterval(() => {
        if (i < text.length) {
          textHal1.textContent += text.charAt(i);
          playTypingSound();
          i++;
        } else {
          clearInterval(typing);
          // tunggu sedikit lalu tampilkan segitiga
          setTimeout(() => {
            talkView.classList.remove("hidden-talk"); // tampilkan + aktifkan animasi lagi
          }, 200);
          if (callback) callback();
        }
      }, speed);
    }
    // tampilkan text dimana conversation yang dipilih dengan urutan teks yang pertama (tapi dalam animasi typing)
    typeText(chooseConversation[indexConversationHal1]);

    // fungsi ganti ke urutan percakapan selanjutnya
    function next1() {
      clickSound.currentTime = 0;
      clickSound.play();

      // pastikan animasi ngetik selesai sebelum lanjut
      if (textHal1.textContent !== chooseConversation[indexConversationHal1])
        return;

      // kalau urutannya lebih kecil dari panjang conversation yang dipilih contoh 3 maka dia dikurang 1 karena mulainya dari 0
      if (indexConversationHal1 < chooseConversation.length - 1) {
        // tambah nilai untuk ganti urutan
        indexConversationHal1++;

        // masukan ke html (dengan animasi typing)
        typeText(chooseConversation[indexConversationHal1]);
      } else {
        hal2.classList.remove("hidden");
        hal2.classList.add("active");
        hal1.classList.add("hidden");

        // mulai animasi typing di hal2
        typeTextHal2(textHal2Content);
      }
    }
    // elemen-elemen halaman 2
    const hal3 = document.getElementById("hal3"); // misal nanti kamu punya hal3
    const textHal2 = document.getElementById("textHal2");
    const talkView2 = document.getElementById("talkview2");

    // teks halaman 2
    const textHal2Content = "anyway, kamu mau masak mie apa hari ini?";

    // fungsi animasi ngetik untuk hal2
    function typeTextHal2(text, callback) {
      textHal2.textContent = "";
      talkView2.classList.add("hidden-talk"); // sembunyikan segitiga

      let i = 0;
      const speed = 40;

      const typing = setInterval(() => {
        if (i < text.length) {
          textHal2.textContent += text.charAt(i);
          playTypingSound();
          i++;
        } else {
          clearInterval(typing);
          setTimeout(() => {
            talkView2.classList.remove("hidden-talk"); // tampilkan segitiga
          }, 200);
          if (callback) callback();
        }
      }, speed);
    }

    // fungsi ganti hal2 ke hal3
    function next2() {
      clickSound.currentTime = 0;
      clickSound.play();

      // Mulai animasi keluar ke kiri untuk hal2
      hal2.classList.add("exit-left");
      hal2.classList.remove("active");

      // Tampilkan hal3 tapi posisinya masih di luar layar kanan
      hal3.classList.remove("hidden");

      // Tambahkan delay sedikit agar transisi bisa terpicu
      setTimeout(() => {
        hal3.classList.add("active");
      }, 50);

      // Setelah animasi selesai, sembunyikan hal2
      setTimeout(() => {
        hal2.classList.add("hidden");
        hal2.classList.remove("exit-left");
      }, 600); // sesuai durasi transition
    }

    const menuBtn = document.getElementById("menuBtn");
    menuBtn.addEventListener("click", gotoMenu);

    function gotoMenu() {
      clickSound.currentTime = 0;
      clickSound.play();

      hal4.classList.add("exit-right");
      hal4.classList.remove("active");

      hal3.classList.remove("hidden");
      hal3.style.transform = "translateX(-100%)"; // mulai dari luar kiri

      setTimeout(() => {
        hal3.classList.add("active");
      }, 50);

      setTimeout(() => {
        hal4.classList.add("hidden");
        hal4.classList.remove("exit-right");
        hal3.style.transform = ""; // reset inline transform
      }, 600); // sesuai durasi transition
    }

    // script untuk pilih menu hal 3
    // variabel object informasi mie
    const noodles = [
      {
        title: "mie kuah biasa",
        img: "img/noodle1.png",
        detail: "waktu masak 3 menit. cocok buat kamu yang suka mie kuah.",
        time: 180,
      },
      {
        title: "mie setengah matang",
        img: "img/noodle2mck.png",
        detail: "waktu masak 1 menit. boleh dicoba kalau kamu anti mainstream.",
        time: 60,
      },
      {
        title: "mie benyek",
        img: "img/noodle1.png",
        detail: "waktu masak 5 menit. cocok kalau kamu orangnya aneh.",
        time: 300,
      },
      {
        title: "mie goyeng",
        img: "img/noodle3mck.png",
        detail: "waktu masak 3 menit. cocok kalau kamu suka yang kering.",
        time: 180,
      },
    ];
    // variabel mie ke berapa
    let mieIndex = 0;
    // variabel komponen informasi mie
    const titleNoodle = document.getElementById("title");
    const imgNoodle = document.getElementById("noodleImg");
    const detailNoodle = document.getElementById("detail");
    const prev = document.getElementById("prevBtn");
    const next = document.getElementById("nextBtn");
    // fungsi ganti mie
    function gantiMie() {
      const mie = noodles[mieIndex];
      titleNoodle.textContent = mie.title;
      imgNoodle.src = mie.img;
      detailNoodle.textContent = mie.detail;
    }

    function animateMie(direction) {
      clickSound.currentTime = 0;
      clickSound.play();

      const oldImg = imgNoodle;

      // tentukan animasi arah
      const outClass =
        direction === "next" ? "slide-out-left" : "slide-out-right";
      const inClass = direction === "next" ? "slide-in-right" : "slide-in-left";

      // animasi keluar
      oldImg.classList.add(outClass);

      // setelah animasi keluar selesai
      setTimeout(() => {
        // ubah data mie
        const mie = noodles[mieIndex];
        oldImg.src = mie.img;
        titleNoodle.textContent = mie.title;
        detailNoodle.textContent = mie.detail;

        // hapus animasi keluar, tambahkan animasi masuk
        oldImg.classList.remove(outClass);
        oldImg.classList.add(inClass);

        // setelah animasi masuk selesai, bersihkan class
        setTimeout(() => {
          oldImg.classList.remove(inClass);
        }, 400);
      }, 400);
    }

    // event listener kalau tombol next ditekan
    next.addEventListener("click", () => {
      // tambah index untuk ganti mie
      mieIndex = (mieIndex + 1) % noodles.length;
      animateMie("next");
      // gantiMie();
    });
    // event listener kalau tombol prev ditekan
    prev.addEventListener("click", () => {
      // kurangi index kemudian tambahkan dengan jumlah objek di satu array
      mieIndex = (mieIndex - 1 + noodles.length) % noodles.length;
      // gantiMie();
      animateMie("prev");
    });
    // inisialisai
    gantiMie();

    // script halaman timer
    const hal4 = document.getElementById("hal4");
    // variabel untuk tampilkan timer
    const timerDisplay = hal4.querySelector("h1");
    // variabel tombol pause dan reset
    const pauseBtn = document.getElementById("pauseBtn");
    const resetBtn = document.getElementById("resetBtn");

    // variabel untuk timer
    let countDown = null;
    // variabel waktu tersisa
    let timeLeft = 0;
    // variabel di pause atau tidak
    let isPaused = false;

    // fungsi update tampilan timer/ update angkanya
    function updateTimerDisplay(seconds) {
      // variabel untuk menit
      const min = String(Math.floor(seconds / 60)).padStart(2, "0");
      // variabel untuk detik
      const sec = String(seconds % 60).padStart(2, "0");
      // tampilkan di h1
      timerDisplay.textContent = `${min}:${sec}`;
    }

    // fungsi tick, fungsi yang dijalankan setiap detik
    function tick() {
      if (isPaused) return;
      // kurangi nilai timeleft sebanyak 1 kali setiap interval berjalan
      timeLeft--;
      // panggil update
      updateTimerDisplay(timeLeft);
      // jika timeleft kurang dari 0 tampilkan selesai
      if (timeLeft <= 0) {
        clearInterval(countDown);
        timerDisplay.textContent = "SELESAI!";
      }
    }

    // fungsi mulai timer
    function startTimer() {
      selectSound.currentTime = 0;
      selectSound.play();

      // sembunyikan hal 3 tampilkan hal 4
      hal3.classList.add("exit-left");
      hal3.classList.remove("active");

      hal4.classList.remove("hidden");

      setTimeout(() => {
        hal4.classList.add("active");
      }, 50);

      setTimeout(() => {
        hal3.classList.add("hidden");
        hal3.classList.remove("exit-left");
      }, 600); // sesuai durasi transition

      // bersihkan interval variabel untuk timer kalau ada
      clearInterval(countDown);
      // ambil waktu dari object mie yang dipilih
      timeLeft = noodles[mieIndex].time;
      // tampilkan waktu di awal (kirim timeleft ke updatetimerdisplay)
      updateTimerDisplay(timeLeft);

      // kalau tidak pause maka jalankan interval
      isPaused = false;
      countDown = setInterval(tick, 1000);
    }

    // event listener tombol pause dan reset
    pauseBtn.addEventListener("click", pauseTimer);
    resetBtn.addEventListener("click", resetTimer);

    // fungsi pause timer
    function pauseTimer() {
      pauseSound.currentTime = 0;
      pauseSound.play();

      // toggle pause/resume (bolak balik)
      isPaused = !isPaused;
      // ganti text di tombol
      pauseBtn.querySelector("p").textContent = isPaused ? "RESUME" : "PAUSE";
    }

    // fungsi reset timer
    function resetTimer() {
      pauseSound.currentTime = 0;
      pauseSound.play();

      clearInterval(countDown);
      timeLeft = noodles[mieIndex].time;
      updateTimerDisplay(timeLeft);
      isPaused = false;
      pauseBtn.querySelector("p").textContent = "PAUSE";
      countDown = setInterval(tick, 1000);
    }

    const toggleBtn = document.getElementById("toggleBGM");
    const bgm = document.getElementById("bgm"); // tambahkan ini
    let bgmPlaying = false;

    toggleBtn.addEventListener("click", () => {
      clickSound.currentTime = 0;
      clickSound.play();

      if (!bgmPlaying) {
        if (!bgm.src) {
          bgm.src = "audio/journey.mp3"; // baru di-set ketika tombol ditekan
          bgm.type = "audio/mpeg";
        }
        bgm.play();
        toggleBtn.textContent = "ðŸ”ˆ";
      } else {
        bgm.pause();
        toggleBtn.textContent = "ðŸ”‡";
      }
      bgmPlaying = !bgmPlaying;
    });
  </script>
</html>
